<div class="container">
  <div class="row">

    <div class="col-md-5">
      <p>The chatbot uses trigram Markov models to generate text, with
      models trained on each of six different corpora. When you input
      something to the chatbot, it identifies which corpus your text
      is most likely to have come from, based on the cross-entropy of
      your text under that corpus model. It then responds with text
      generated from that corpus and seeded with your text.</p>

      <p>Each corpus comes from the body of work of one
      author/playwright/songwriter and is assigned a nickname that
      clues a number. After you figure out who the authors are and fit
      their last names into the blanks given, you index the number
      clued by each one's nickname into their name and reading down
      the blanks.</p>

      <table>
	<tr><th>Author</th><th>Nickname</th><th>Letter</th></tr>
	<tr><td>Whitman</td><td>Wonderland</td><td>W</td></tr>
	<tr><td>Nixon</td><td>Tulip</td><td>I</td></tr>
	<tr><td>Rand</td><td>Threesome</td><td>N</td></tr>
	<tr><td>Grande</td><td>Forehead</td><td>N</td></tr>
	<tr><td>Aguilera</td><td>Sick Soup</td><td>E</td></tr>
	<tr><td>Shakespeare</td><td>Tentacle</td><td>R</td></tr>
      </table>
    </div>
  </div>

  <div class="row">

    <div class="col-md-5">
      <div class="panel panel-primary chatbox" id='chatbox' data-chatbot='/dynamic/puzzle/chatbot'>
        <div class="panel-heading">
          <span class="glyphicon glyphicon-comment"></span> Chat
        </div>
        <div class="panel-body">
          <ul class="chat">
        </ul>
      </div>
      <div class="panel-footer">
        <div class="input-group">
          <input id="btn-input" type="text" class="form-control input-sm btn-input" placeholder="Type your message here..." />
          <span class="input-group-btn">
            <button class="btn btn-warning btn-sm btn-chat">
              Send</button>
            </span>
          </div>
        </div>
      </div>
    </div>

    <div class="col-md-5">
      <p>
        <span class='underscore'></span><span class='underscore'></span><span class='underscore'></span><span class='underscore'></span><span class='underscore'></span><span class='underscore'></span><span class='underscore'></span>
      </p>
      <p>
        <span class='underscore'></span><span class='underscore'></span><span class='underscore'></span><span class='underscore'></span><span class='underscore'></span>
      </p>
      <p>
        <span class='underscore'></span><span class='underscore'></span><span class='underscore'></span><span class='underscore'></span>
      </p>
      <p>
        <span class='underscore'></span><span class='underscore'></span><span class='underscore'></span><span class='underscore'></span><span class='underscore'></span><span class='underscore'></span>
      </p>
      <p>
        <span class='underscore'></span><span class='underscore'></span><span class='underscore'></span><span class='underscore'></span><span class='underscore'></span><span class='underscore'></span><span class='underscore'></span><span class='underscore'></span>
      </p>
      <p>
        <span class='underscore'></span><span class='underscore'></span><span class='underscore'></span><span class='underscore'></span><span class='underscore'></span><span class='underscore'></span><span class='underscore'></span><span class='underscore'></span><span class='underscore'></span><span class='underscore'></span><span class='underscore'></span>
      </p>
    </div>

  </div>

</div>

<style>
  .underscore{
    width: 10px;
    padding: 10px;
    margin: 0 5px;
    border-bottom: 1px solid;
  }

  .panel-body
  {
    overflow-y: scroll;
    height: 300px;
  }
  .chat
{
    list-style: none;
    margin: 0;
    padding: 0;
}

  .chat li
  {
    margin-bottom: 10px;
    padding-bottom: 5px;
    border-bottom: 1px dotted #B3A9A9;
  }

  .chat li .chat-body p
  {
    margin: 0;
    color: #777777;
  }

  .chat-reset {
    float: right;
    color: #eee;
    cursor: pointer;
  }



</style>

<script type="text/javascript">
//<![CDATA[
function clickChat(chatbox){
  var input = chatbox.find('.btn-input');
  var text = input.val();
  if(text.length > 0){
    insertChat(chatbox, 'You', text);
    input.val('');
    scrollchat(chatbox);
    $.get(chatbox.data('chatbot'), { data: text }, function(data) {
      insertChat(chatbox, data.name, data.response);
      scrollchat(chatbox);
    });
    
    
  }
}

function scrollchat(chatbox){
  var panel = chatbox.find('.panel-body');
  panel.animate({ scrollTop: panel[0].scrollHeight}, 300);
}

function insertChat(chatbox, user, text){
  var chat = $('<li><div class="header"><strong class="primary-font chat-name"></strong></div><p class="chat-body"></p></li>');
  chat.find('.chat-body').text(text);
  chat.find('.chat-name').text(user);
  chatbox.find('.chat').append(chat); 
}

document.addEventListener("DOMContentLoaded", function(event) { 
  $('.btn-chat').on('click', function(){
            clickChat($(this).parents('.chatbox'));
  });

  $('.btn-input').on('keypress', function(e){
    if(e.keyCode === 13)
    {
        clickChat($(this).parents('.chatbox'));
        e.preventDefault();
    }
  });

});
//]]>
</script>
